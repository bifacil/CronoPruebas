

<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Design Tip #113 Creating, Using, and Maintaining Junk Dimensions</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description">
		<meta name="application-name">
		<meta name="title">
		<link href="../../../favicon.ico" rel="shortcut icon" />
		<link rel="stylesheet" href="../../../resources/main.css">
	</head>
	

	<body>
	
		<div class="jumbotron1" id="jumbotron1">
			<div class="container">
				<h1 class="article-header">Design Tip #113 Creating, Using, and Maintaining Junk Dimensions</h1>
				<div class="article-date">mi&#233;rcoles, 3 de junio de 2009</div>
			</div>
		</div>
	
		<hr id="anchor-point"/>
		<div class="container-fluid">
			<a href="../../../archive/bi/dwh/design-tip-113-creating-using-and-maintaining-junk-dimensions.html#" class="navigationBars">
				<div class="iconBars closed">
					<span id="icon-bar1" class="iconBar colorChange background"></span>
					<span id="icon-bar2" class="iconBar colorChange background"></span>
					<span id="icon-bar3" class="iconBar colorChange background"></span>
				</div>
			</a>
			<div class="navLinks">
				<a id="link1" class="colorChange navLink link1" href="../../../index.html">Home</a>
				<a class="iconLink" href="../../../index.html"><i title="Home" id="icon1" class="fa fa-home colorChange link1"></i></a>
	
				<a id="link2" class="colorChange navLink link2" href="../../../about.html">Sobre mi</a>
				<a class="iconLink" href="../../../about.html"><i title="Sobre mi" id="icon2" class="fa fa-envelope colorChange link2"></i></a>

				<a id="link2" class="colorChange navLink link3" href="../../../archive.html">Archivo</a>
				<a class="iconLink" href="../../../about.html"><i title="Archivo" id="icon3" class="fa fa-archive colorChange link3"></i></a>
			</div>			
			
			<div class="row">
				<div class="content col-sm-8 col-sm-offset-2 col-xs-10 col-xs-offset-1">
					<div class="article">
						<p class="article-description"></p>				
						<div class="article-content">
							<div class="pf-content">
							<p>A junk dimension combines several low-cardinality flags and attributes into a single dimensionÂ table rather than modeling them as separate dimensions. There are good reasons to create thisÂ combined dimension, including reducing the size of the fact table and making the dimensional modelÂ easier to work with. Margy described junk dimensions in detail in Kimball Design Tip #48: De-ClutterÂ with Junk (Dimensions). On a recent project, I addressed three aspects of junk dimension processing:Â building the initial dimension, incorporating it into the fact processing, and maintaining it over time.</p>
							<p><strong>Build the Initial Junk Dimension</strong><br> If the cardinality of each attribute is relatively low, and there are only a few attributes, then the easiestÂ way to create the dimension is to cross-join the source system lookup tables. This creates all possibleÂ combinations of attributes, even if they might never exist in the real world.</p>
							<p>If the cross-join of the source tables is too big, or if you donâ€™t have source lookup tables, you will needÂ to build your junk dimension based on the actual attribute combinations found in the source data for theÂ fact table. The resulting junk dimension is often significantly smaller because it includes onlyÂ combinations that actually occur.</p>
							<p>Weâ€™ll use a simple health care example to show both of these combination processes. HospitalÂ admissions events often track several standalone attributes, including the admission type and level ofÂ care required, as illustrated below in the sample rows from the source system lookup and transactionÂ tables.</p>
							<p><img class="ether-frame ether-frame-1 alignnone" title="dt113" src="../../../wp-content/uploads/2012/06/dt113-e13402262128251.png" alt="" width="600" height="147"></p>
							<p>The following SQL uses the cross-join technique to create all 12 combinations of rows (4&#215;3) from theseÂ two source tables and assign unique surrogate keys.</p>
							<p>SELECT ROW_NUMBER() OVER( ORDER BY Admit_Type_ID, Care_Level_ID) AS<br> Admission_Info_Key,<br> Admit_Type_ID, Admit_Type_Descr, Care_Level_ID, Care_Level_Descr<br> FROM Admit_Type_Source<br> CROSS JOIN Care_Level_Source;</p>
							<p>In the second case, when the cross-join would yield too many rows, you can create the combinedÂ dimension based on actual combinations found in the transaction fact records. The following SQLÂ uses outer joins to prevent a violation of referential integrity when a new value shows up in a factÂ source row that is not in the lookup table.</p>
							<p>SELECT ROW_NUMBER() OVER(ORDER BY F.Admit_Type_ID) AS<br> Admission_Info_Key,<br> F.Admit_Type_ID, ISNULL(Admit_Type_Descr, &#8216;Missing Description&#8217;)<br> Admit_Type_Descr,<br> F.Care_Level_ID, ISNULL(Care_Level_Descr, &#8216;Missing Description&#8217;)<br> Care_Level_Descr &#8212; substitute NVL() for ISNULL() in Oracle<br> FROM Fact_Admissions_Source F<br> LEFT OUTER JOIN Admit_Type_Source C ON<br> F.Admit_Type_ID = C.Admit_Type_ID<br> LEFT OUTER JOIN Care_Level_Source P ON<br> F.Care_Level_ID = P.Care_Level_ID;</p>
							<p>Our example Fact_Admissions_Source table only has four rows which result in the followingÂ Admissions_Info junk dimension. Note the Missing Description entry in row 4.</p>
							<p><img class="ether-frame ether-frame-1 alignnone" title="dt113b" src="../../../wp-content/uploads/2012/06/dt113b-e13402264925581.png" alt="" width="600" height="117"></p>
							<p><strong>Incorporate the Junk Dimension into the Fact Row Process</strong><br> Once the junk dimension is in place, you will use it to look up the surrogate key that corresponds to theÂ combination of attributes found in each fact table source row. Some of the ETL tools do not support aÂ multi-column lookup join, so you may need to create a work-around. In SQL, the lookup query wouldÂ be similar to the second set of code above, but it would join to the junk dimension and return theÂ surrogate key rather than joining to the lookup tables.</p>
							<p><strong>Maintain the Junk Dimension</strong><br> You will need to check for new combinations of attributes every time you load the dimension. YouÂ could apply the second set of SQL code to the incremental fact rows and select out only the new rowsÂ to be appended to the junk dimension as shown below.</p>
							<p>SELECT * FROM ( {Select statement from second SQL code listing} ) TabA<br> WHERE TabA.Care_Level_Descr = &#8216;Missing Description&#8217;<br> OR TabA.Admit_Type_Descr = &#8216;Missing Description&#8217; ;</p>
							<p>In this example, it would select out row 4 in the junk dimension. Identifying new combinations could beÂ done as part of the fact table surrogate key substitution process, or as a separate dimensionÂ processing step prior to the fact table process. In either case, your ETL system should raise a flag andÂ notify the appropriate data steward if it identifies a missing entry.</p>
							<p>There are a lot of variations on this approach depending on the size of your junk dimension, theÂ sources you have, and the integrity of their data, but these examples should get you started. Send meÂ an email if youâ€™d like a copy of the code to create this example in SQL Server or Oracle.</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script src="../../../resources/jquery.min.js"></script>
		<script src="../../../resources/menu.js"></script>
			
		
		<a id="scrollUp" href="../../../archive/bi/dwh/design-tip-113-creating-using-and-maintaining-junk-dimensions.html#top" title="Volver" style="position: fixed; z-index: 2147483647; display: none;">
			<i class="fa fa-chevron-up"></i>
		</a>
	</body>
</html>